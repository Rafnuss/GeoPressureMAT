function sp = shortestPathGraph(gr)% Build the grpahG = digraph(gr.s,gr.t,-log(gr.po(gr.t) .* double(gr.pt)));% search shortest path[~,id_first] = max(gr.po(gr.firstNodes));[~,id_last] = max(gr.po(gr.lastNodes));[sp.path,~,edgepath] = shortestpath(G,gr.firstNodes(id_first),gr.lastNodes(id_last));% get lat and lon of shortest path[sp.lon, sp.lat, ~] = path2lonlat(sp.path,gr);% as well as edge informationsp.gs = gr.gs(edgepath);sp.as = gr.as(edgepath);sp.ws = gr.ws(edgepath);sp.edge = edgepath;if false    figure; hold on; borders('countries','k');    plot(sp.lon, sp.lat,'-o')endend